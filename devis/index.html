<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Devis dentaire ‚Äî Smile Tunisia</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flag-icons@6.6.6/css/flag-icons.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/style.css">

  <style>
    /* --- Layout shell --- */
    .wrap{max-width:1100px;margin:28px auto}
    .qgrid{display:grid;grid-template-columns:1.25fr .75fr;gap:18px}
    @media (max-width: 980px){ .qgrid{grid-template-columns:1fr} }

    /* --- Trust belt --- */
    .trust-rail{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 16px}
    .t-badge{
      background:#0f172a; color:#e5e7eb; border-radius:999px; padding:8px 12px; font-weight:700; font-size:12px;
      box-shadow:0 8px 22px rgba(15,23,42,.18);
    }

    /* --- Left: form --- */
    .form{background:#fff;border:1px solid #eee;border-radius:16px;padding:18px;box-shadow:0 8px 26px rgba(0,0,0,.06)}
    form{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    form .full{grid-column:1/-1}
    textarea{min-height:140px}

    /* Inputs */
    input, select, textarea{
      width:100%; padding:10px 12px; border:1px solid #e6e6f0; border-radius:12px; font:inherit; background:#fff;
      transition:border-color .12s ease, box-shadow .12s ease, background .12s ease;
    }
    input:focus, select:focus, textarea:focus{ outline:none; border-color:var(--turq); box-shadow:0 0 0 3px rgba(90,195,204,.25) }

    /* Notice */
    .notice{padding:10px 12px;background:#f7f7fb;border-left:3px solid var(--turq);border-radius:8px;margin:8px 0}
    .notice.error{ background:#fef2f2; border-left-color:#ef4444; color:#7f1d1d }
    .notice.success{ background:#ecfdf5; border-left-color:#10b981; color:#064e3b }

    /* Drag & drop area */
    .files{grid-column:1/-1;border:1px dashed #d1d5db;padding:14px;border-radius:12px;background:#fafafa}
    .drop{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .drop .help{color:var(--muted)}
    .drop .btn-mini{border:1px solid #e6e6f0;background:#fff;border-radius:999px;padding:8px 12px;font-weight:700}
    .dropzone{
      margin-top:8px; background:#fff; border:1px dashed #cbd5e1; border-radius:12px; padding:16px; text-align:center;
      color:#475569; transition:border-color .15s ease, background-color .15s ease;
    }
    .dropzone.drag{ background:#f0fbfc; border-color:var(--turq); }
    .gallery{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .gallery .thumb{position:relative}
    .gallery img{height:64px;width:auto;border-radius:10px;border:1px solid #e6e6f0;display:block}
    .thumb button{
      position:absolute;top:-6px;right:-6px;border:0;background:#ef4444;color:#fff;width:22px;height:22px;border-radius:50%;cursor:pointer;
      font-weight:800; line-height:0; box-shadow:0 6px 14px rgba(239,68,68,.35);
    }

    /* Treatment radio cards */
    .treat-grid{grid-column:1/-1;display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
    @media (max-width: 900px){ .treat-grid{grid-template-columns:1fr 1fr} }
    .tcard{position:relative}
    .tcard input{position:absolute;inset:0;opacity:0}
    .tcard .visual{
      display:flex;gap:8px;align-items:center;background:#fff;border:1px solid #e6e6f0;border-radius:14px;padding:10px 12px;min-height:58px;
      transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease, background-color .15s ease;
      box-shadow:0 4px 14px rgba(0,0,0,.04)
    }
    .tcard .visual:hover{transform:translateY(-2px); box-shadow:0 10px 24px rgba(59,91,167,.14); border-color:rgba(59,91,167,.25)}
    .tcard input:checked + .visual{background:var(--lav); border-color:var(--turq); box-shadow:0 12px 30px rgba(90,195,204,.28); color:#0a2d30}

    /* Segmented control (urgency) */
    .seg{grid-column:1/-1;display:flex;gap:8px;flex-wrap:wrap}
    .seg label{position:relative}
    .seg input{position:absolute;inset:0;opacity:0}
    .seg span{display:inline-block;padding:8px 12px;border:1px solid #e6e6f0;border-radius:999px;background:#fff;font-weight:700}
    .seg span:hover{background:#f8fafc;border-color:rgba(59,91,167,.22)}
    .seg input:checked + span{background:var(--turq);color:#063b3f;border-color:var(--turq);box-shadow:0 10px 24px rgba(90,195,204,.28)}

    /* Actions */
    .actions{grid-column:1/-1;display:flex;gap:12px;align-items:center}
    progress{width:220px;height:16px}

    /* Live completion */
    .meter{height:10px;background:#f1f5f9;border-radius:999px;overflow:hidden}
    .meter > span{display:block;height:100%;background:linear-gradient(90deg,var(--turq),#7ad0d7);width:0%}

    /* Consent (checkbox left, text right) */
    .consent{
      grid-column:1/-1;
      display:grid;
      grid-template-columns:20px 1fr;
      gap:12px;
      align-items:start;
      cursor:pointer;
    }
    .consent input[type="checkbox"]{ width:20px;height:20px;margin:0 }
    .consent span{ line-height:1.35 }

    /* Reassurance column */
    .reassure{position:sticky;top:84px;height:max-content;display:flex;flex-direction:column;gap:12px}
    .r-card{background:#fff;border:1px solid #eee;border-radius:16px;padding:14px;box-shadow:0 8px 26px rgba(0,0,0,.06)}
    .r-card.doctor{display:flex;gap:12px;align-items:center}
    .r-card.doctor img{width:64px;height:64px;border-radius:12px;object-fit:cover;border:1px solid #e6e6f0}

    /* Mini reviews */
    .stars{color:var(--turq);font-weight:800}
    .mini-reviews{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
    .review-mini{display:flex;align-items:center;gap:8px;background:#fff;border:1px solid #eee;border-radius:999px;padding:6px 10px}
    .avatar{width:26px;height:26px;border-radius:50%;background:var(--turq,#06b6d4);color:#063b3f;font-weight:800;display:flex;align-items:center;justify-content:center}

    /* FAQ */
    .r-faq{background:#0f172a;color:#e5e7eb;border-radius:12px;padding:10px 12px}
    .r-faq summary{cursor:pointer;font-weight:700}

    /* Honeypot */
    .hp{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}

    /* Icon images in treatment cards */
    .ticon{
      width:28px;height:28px;border-radius:6px;object-fit:cover;flex:0 0 28px;display:block;box-shadow:0 1px 0 rgba(0,0,0,.04)
    }
    @media (min-width: 900px){ .ticon{ width:32px;height:32px } }

    /* --- Success modal (clean) --- */
    dialog.modal{ border:0;border-radius:16px;padding:18px;width:min(520px,92vw);box-shadow:0 24px 60px rgba(15,23,42,.35);animation:pop .16s ease-out;background:#fff }
    dialog::backdrop{ background:rgba(15,23,42,.55) }
    @keyframes pop{ from{transform:scale(.98);opacity:0} to{transform:scale(1);opacity:1} }

    .modal-head{display:flex;align-items:center;gap:12px;margin-bottom:8px}
    .modal-head .badge{background:#10b981;color:#063b3f;font-weight:800;font-size:12px;padding:6px 10px;border-radius:999px}

    .checkwrap{
      width:44px;height:44px;border-radius:50%;
      background:radial-gradient( circle at 30% 30%, #b3f7da, #10b981 );
      display:grid;place-items:center;color:#053b2e;flex:0 0 44px;font-weight:900
    }
    .ref{font-weight:700;color:#065f46}
    .modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:14px}
    .small{font-size:12px;color:#64748b;margin-top:6px}
    .copy-btn{border:1px solid #10b981;background:#ecfdf5;color:#065f46;border-radius:999px;padding:6px 10px;font-weight:700}
    
    /* Country autocomplete */
    .ac{ position:relative }
    .ac::after{
      content:""; position:absolute; right:12px; top:50%; width:10px; height:10px;
      transform:translateY(-50%) rotate(45deg);
      border-right:2px solid #94a3b8; border-bottom:2px solid #94a3b8; pointer-events:none;
    }
    .ac-list{
      position:absolute; left:0; right:0; top:calc(100% + 8px);
      background:#0f172a; color:#e5e7eb; border:1px solid rgba(255,255,255,.06);
      border-radius:14px; padding:6px; box-shadow:0 20px 48px rgba(15,23,42,.35);
      max-height:260px; overflow:auto; z-index:9999;
    }
    .ac-list::-webkit-scrollbar{ width:8px } 
    .ac-list::-webkit-scrollbar-thumb{ background:#1f2937; border-radius:999px }
    .ac-item{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px; border-radius:10px; cursor:pointer; font-weight:600;
    }
    .ac-item .dot{
      width:10px; height:10px; border-radius:50%;
      background:linear-gradient(90deg,var(--turq,#06b6d4),#7ad0d7);
      box-shadow:0 0 0 3px rgba(90,195,204,.18);
    }
    .ac-item:hover, .ac-item.is-active{ background:#111827 }
    .ac-empty{ padding:8px 10px; color:#9ca3af; font-size:12px }
  </style>
</head>

<body data-whatsapp="21600000000">
  <header>
    <nav>
      <div class="container">
        <a class="brand" href="../"><img src="../assets/img/logo-horiz.jpg" alt="Smile Tunisia" /></a>
        <div class="spacer"></div>
        <a class="btn btn-outline" href="../">‚Üê Retour</a>
      </div>
    </nav>
  </header>

  <div class="container wrap">
    <h1>Devis dentaire gratuit</h1>
    <p class="lead">R√©ponse <b>sous 24 h</b>, sans engagement. Transmission <b>s√©curis√©e</b>.</p>

    <!-- Trust belt -->
    <div class="trust-rail" aria-label="Indicateurs de confiance">
      <span class="t-badge">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ Avis v√©rifi√©s</span>
      <span class="t-badge">+500 patients accompagn√©s</span>
      <span class="t-badge">R√©seau de cliniques certifi√©es</span>
      <span class="t-badge">Planification 3D (CBCT)</span>
      <span class="t-badge">Devis clair ¬∑ 0 frais cach√©s</span>
    </div>

    <div class="qgrid">
      <!-- LEFT: FORM -->
      <section class="form" aria-label="Formulaire de demande de devis">
        <div class="meter full" aria-hidden="true"><span id="meter"></span></div>

        <form id="qform" novalidate>
          <div>
            <label>Nom et pr√©nom *</label>
            <input name="name" required maxlength="120" placeholder="Votre nom complet" />
          </div>
          <div>
            <label>Email *</label>
            <input name="email" type="email" required placeholder="vous@example.com" />
          </div>

          <div>
            <label>T√©l√©phone / WhatsApp *</label>
            <input name="phone" required placeholder="+216 ..." inputmode="tel" />
          </div>

          <!-- PAYS (custom autocomplete; no 'Autre') -->
          <div id="countryField">
            <label for="countryInput">Pays</label>
            <div class="ac" id="countryAC">
              <input id="countryInput" name="country"
                     placeholder="Commencez √† taper‚Ä¶"
                     autocomplete="off" autocapitalize="none" spellcheck="false"
                     role="combobox" aria-autocomplete="list" aria-expanded="false"
                     aria-controls="countryList" aria-activedescendant="">
              <ul class="ac-list" id="countryList" role="listbox" hidden></ul>
            </div>
          </div>

          <!-- Treatments -->
          <input type="hidden" name="treatment" id="treatHidden" />
          <div class="treat-grid">
            <label class="tcard">
              <input type="radio" name="treatChoice" value="Implant dentaire">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/implant.png"
                     srcset="../assets/img/icons/implant.png 1x, ../assets/img/icons/implant@2x.png 2x" alt="Implant dentaire">
                <b>Implant</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Arcade compl√®te ‚Äî All-on-4/6">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/all-on-4-6.png"
                     srcset="../assets/img/icons/all-on-4-6.png 1x, ../assets/img/icons/all-on-4-6@2x.png 2x" alt="All-on-4/6">
                <b>All-on-4/6</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Facettes dentaires">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/facettes.png"
                     srcset="../assets/img/icons/facettes.png 1x, ../assets/img/icons/facettes@2x.png 2x" alt="Facettes dentaires" loading="lazy">
                <b>Facettes</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Orthodontie (aligneurs)">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/aligneurs.png"
                     srcset="../assets/img/icons/aligneurs.png 1x, ../assets/img/icons/aligneurs@2x.png 2x" alt="Orthodontie (aligneurs)" loading="lazy">
                <b>Aligneurs</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Couronnes / Bridges">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/crowns-bridge.png"
                     srcset="../assets/img/icons/crowns-bridge.png 1x, ../assets/img/icons/crowns-bridge@2x.png 2x" alt="Couronnes / Bridges">
                <b>Couronnes / Bridges</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Proth√®ses dentaires">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/protheses.png"
                     srcset="../assets/img/icons/protheses.png 1x, ../assets/img/icons/protheses@2x.png 2x" alt="Proth√®ses dentaires">
                <b>Proth√®ses dentaires</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Endodontie (d√©vitalisation)">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/endodontie.png"
                     srcset="../assets/img/icons/endodontie.png 1x, ../assets/img/icons/endodontie@2x.png 2x" alt="Endodontie (d√©vitalisation)">
                <b>Endodontie</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Traitement des caries">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/caries.png"
                     srcset="../assets/img/icons/caries.png 1x, ../assets/img/icons/caries@2x.png 2x" alt="Traitement des caries">
                <b>Caries</b>
              </span>
            </label>

            <label class="tcard">
              <input type="radio" name="treatChoice" value="Blanchiment dentaire">
              <span class="visual">
                <img class="ticon" src="../assets/img/icons/whitening.png"
                     srcset="../assets/img/icons/whitening.png 1x, ../assets/img/icons/whitening@2x.png 2x" alt="Blanchiment dentaire">
                <b>Blanchiment</b>
              </span>
            </label>
          </div>

          <!-- Urgency -->
          <div class="seg" role="group" aria-label="Disponibilit√©">
            <label><input type="radio" name="urgency" value="D√®s que possible"><span>üìÖ D√®s que possible</span></label>
            <label><input type="radio" name="urgency" value="Dans 1‚Äì3 mois"><span>üóìÔ∏è 1‚Äì3 mois</span></label>
            <label><input type="radio" name="urgency" value="Plus tard"><span>‚è≥ Plus tard</span></label>
          </div>

          <!-- Files -->
          <div class="files">
            <div class="drop">
              <div class="help">T√©l√©versez une <b>photo de vos dents</b> (smartphone ok) ou une <b>radio panoramique</b>.</div>
              <button type="button" id="chooseBtn" class="btn-mini">Choisir des fichiers</button>
            </div>
            <div id="dz" class="dropzone">Glissez-d√©posez ici vos photos / PDF (max 10, 10&nbsp;MB chacun)</div>
            <input id="files" name="files" type="file" multiple accept="image/*,.pdf" hidden />
            <div id="gallery" class="gallery" aria-live="polite"></div>
            <p class="note">Conseil : une photo bouche ouverte + un selfie sourire aident √† estimer votre cas.</p>
          </div>

          <textarea class="full" name="notes" maxlength="5000"
            placeholder="Votre objectif : dents manquantes, esth√©tique, douleur‚Ä¶ Ajoutez tout d√©tail utile."></textarea>

          <!-- Consent -->
          <label class="consent">
            <input type="checkbox" id="consent" required>
            <span>J‚Äôaccepte de recevoir mon devis et des informations par WhatsApp et email (confidentiel, pas de spam).</span>
          </label>
          <p class="note full">Transmission chiffr√©e (HTTPS). Acc√®s restreint √† l‚Äô√©quipe soignante. <a href="../legal/confidentialite.html">Politique de confidentialit√©</a>.</p>

          <div id="msg" class="notice full" style="display:none"></div>

          <div class="actions">
            <button class="btn btn-turq" id="submitBtn" type="button">Envoyer ma demande</button>
            <progress id="prog" value="0" max="100" style="display:none"></progress>
            <span id="status" class="note"></span>
          </div>

          <!-- Honeypot anti-spam -->
          <input type="text" name="website" tabindex="-1" autocomplete="off" class="hp" aria-hidden="true" />
        </form>
      </section>

      <!-- RIGHT: reassurance -->
      <aside class="reassure" aria-label="Rassurance">
        <div class="r-card doctor">
          <picture class="doc-photo">
            <source srcset="../assets/img/illustrations/team-avatar@2x.webp 2x, ../assets/img/illustrations/team-avatar.webp 1x" type="image/webp">
            <img class="team-avatar" src="../assets/img/illustrations/team-avatar.jpg" width="72" height="72" alt="√âquipe m√©dicale certifi√©e">
          </picture>
          <div>
            <b>√âquipe m√©dicale certifi√©e</b><br>
            Implantologie & esth√©tique ‚Äî r√©seau de cliniques audit√©es.<br>
            <span class="note">‚ÄúProtocoles s√ªrs, mat√©riaux CE/FDA, r√©sultat naturel.‚Äù</span>
          </div>
        </div>

        <div class="r-card">
          <b>Ce que vous recevez</b>
          <ul class="list">
            <li>Un <b>devis clair</b> avec options & d√©lais</li>
            <li>Une <b>explication du protocole</b> propos√©</li>
            <li>Un <b>conseiller d√©di√©</b> sur WhatsApp</li>
          </ul>
        </div>

        <div class="r-card">
          <b>Donn√©es & confidentialit√©</b>
          <ul class="list">
            <li>Envoi via <b>connexion s√©curis√©e (HTTPS)</b></li>
            <li>Acc√®s limit√© √† l‚Äô√©quipe soignante</li>
            <li><b>Suppression sur demande</b> (RGPD)</li>
          </ul>
        </div>

        <div class="r-card">
          <b>Et apr√®s ?</b>
          <ol class="list">
            <li>√âtude de vos photos/radio</li>
            <li>Devis sous 24 h avec options</li>
            <li>Organisation du s√©jour si souhait√©</li>
          </ol>
        </div>

        <div class="r-card">
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <div class="mini-reviews">
            <div class="review-mini"><div class="avatar">SB</div><div class="txt"><b>‚ÄúFacettes impeccables.‚Äù</b></div></div>
            <div class="review-mini"><div class="avatar">ML</div><div class="txt"><b>‚ÄúAll-on-4 en 5 jours.‚Äù</b></div></div>
            <div class="review-mini"><div class="avatar">AK</div><div class="txt"><b>‚ÄúSuivi WhatsApp rassurant.‚Äù</b></div></div>
          </div>
        </div>

        <details class="r-faq"><summary>Le devis est-il payant ?</summary><p>Non, il est <b>gratuit</b> et sans engagement.</p></details>
        <details class="r-faq"><summary>Dois-je avancer des frais ?</summary><p>Aucun frais avant la premi√®re visite. Vols/h√¥tel √† votre charge si vous organisez seul.</p></details>
        <details class="r-faq"><summary>Et si je n‚Äôai pas de radio ?</summary><p>Envoyez juste des <b>photos</b>. Une radio pourra √™tre prescrite ensuite si besoin.</p></details>

        <a class="btn btn-outline" href="javascript:void(0)" onclick="openWhatsApp()">Parler √† un conseiller</a>
      </aside>
    </div>
  </div>

  <script>
    // --- Config ---
    const API_URL =
      (location.port === '5500' || location.hostname === '127.0.0.1' || location.hostname === 'localhost')
        ? 'http://localhost:3000/api/quotes/multipart'
        : '/api/quotes/multipart';

    const MAX_FILES = 10, MAX_SIZE = 10 * 1024 * 1024;

    // --- Helpers ---
    function $(sel, el=document){ return el.querySelector(sel); }
    function $all(sel, el=document){ return Array.from(el.querySelectorAll(sel)); }

   function showMessage(text, type = 'info', durationMs = 0) {
  const msg = document.getElementById('msg');
  msg.innerHTML = text;
  msg.className = 'notice full ' + (type === 'success' ? 'success' : type === 'error' ? 'error' : '');
  msg.style.display = 'block';
  msg.setAttribute('role', 'alert');
  msg.setAttribute('aria-live', 'polite');

  // optional auto-hide only if a duration is provided
  clearTimeout(msg.__hideTimer);
  if (durationMs > 0) {
    msg.__hideTimer = setTimeout(() => { msg.style.display = 'none'; }, durationMs);
  }
}


    function openWhatsApp(){
      const phone = document.body.dataset.whatsapp || '';
      const msg = encodeURIComponent("Bonjour, je souhaite des informations pour un devis dentaire.");
      window.open(`https://wa.me/${phone}?text=${msg}`, '_blank');
    }
    window.openWhatsApp = window.openWhatsApp || openWhatsApp;

    // --- Treatment: radio -> hidden field ---
    (function(){
      const hidden = $('#treatHidden');
      const radios = $all('input[name="treatChoice"]');
      function sync(){ const r = radios.find(x=>x.checked); hidden.value = r ? r.value : ''; }
      radios.forEach(r => r.addEventListener('change', sync)); sync();
    })();

    // --- Drag & drop uploader with previews & remove ---
    (function(){
      const dz = $('#dz'), input = $('#files'), gal = $('#gallery'), chooseBtn = $('#chooseBtn');
      chooseBtn.addEventListener('click', ()=> input.click());
      dz.addEventListener('click', ()=> input.click());

      const setDrag = on => dz.classList.toggle('drag', !!on);
      ['dragenter','dragover'].forEach(ev => dz.addEventListener(ev, e => {
        e.preventDefault(); setDrag(true);
        if (e.dataTransfer) e.dataTransfer.dropEffect = 'copy';
      }));
      ['dragleave','drop'].forEach(ev => dz.addEventListener(ev, e => { e.preventDefault(); setDrag(false); }));

      dz.addEventListener('drop', e=>{
        const files = Array.from(e.dataTransfer.files || []);
        pushFiles(files);
      });
      input.addEventListener('change', ()=> pushFiles(Array.from(input.files)));

      const bag = [];
      function pushFiles(files){
        for(const f of files){
          if (bag.length >= MAX_FILES) break;
          if (f.size > MAX_SIZE){ showMessage('Un fichier d√©passe 10 MB et a √©t√© ignor√©.', true); continue; }
          bag.push(f);
        }
        render(); syncInput();
      }
      function removeAt(i){ bag.splice(i,1); render(); syncInput(); }
      function syncInput(){
        const dt = new DataTransfer();
        bag.forEach(f => dt.items.add(f));
        input.files = dt.files;
      }
      function render(){
        gal.innerHTML = '';
        bag.forEach((f,i)=>{
          const holder = document.createElement('div'); holder.className='thumb';
          const img = document.createElement('img');
          if (f.type.startsWith('image/')) img.src = URL.createObjectURL(f);
          else {
            img.alt = f.name;
            img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="96" height="64"><rect width="96" height="64" rx="8" fill="%23eef2ff"/><text x="48" y="38" text-anchor="middle" font-family="sans-serif" font-size="12" fill="%236b7280">PDF</text></svg>';
          }
          const x = document.createElement('button'); x.type='button'; x.textContent='√ó'; x.title='Supprimer';
          x.addEventListener('click', ()=> removeAt(i));
          holder.append(img,x); gal.append(holder);
        });
      }
      window.__getFiles = ()=> bag.slice();
      window.__resetFiles = ()=> { bag.length = 0; render(); syncInput(); };
    })();

    // --- Live completion meter ---
    (function(){
      const meter = $('#meter'), form = $('#qform');
      const tests = [
        f => !!f.name.value.trim(),
        f => !!f.email.value && f.email.validity.valid,
        f => !!f.phone.value.trim(),
        _ => (window.__getFiles?.().length || 0) > 0,
        _ => $('#consent').checked
      ];
      function update(){
        const f = form; let ok = 0; tests.forEach(t => ok += t(f) ? 1 : 0);
        const pct = Math.round((ok / tests.length) * 100);
        meter.style.width = pct + '%';
      }
      form.addEventListener('input', update);
      form.addEventListener('change', update);
      setInterval(update, 800);
    })();

    // ----- Country list (FR labels) -----
    const COUNTRIES = [
      "Afghanistan","Afrique du Sud","Albanie","Alg√©rie","Allemagne","Andorre","Angola","Antigua-et-Barbuda","Arabie saoudite",
      "Argentine","Arm√©nie","Australie","Autriche","Azerba√Ødjan","Bahamas","Bahre√Øn","Bangladesh","Barbade","Belgique",
      "Belize","B√©nin","Bhoutan","Bi√©lorussie","Birmanie","Bolivie","Bosnie-Herz√©govine","Botswana","Br√©sil","Brunei",
      "Bulgarie","Burkina Faso","Burundi","Cambodge","Cameroun","Canada","Cap-Vert","Chili","Chine","Chypre","Colombie",
      "Comores","Congo (Brazzaville)","Congo (RDC)","Cor√©e du Nord","Cor√©e du Sud","Costa Rica","C√¥te d‚ÄôIvoire","Croatie",
      "Cuba","Danemark","Djibouti","Dominique","√âgypte","√âmirats arabes unis","√âquateur","√ârythr√©e","Espagne","Estonie",
      "Eswatini","√âtats-Unis","√âthiopie","Fidji","Finlande","France","Gabon","Gambie","G√©orgie","Ghana","Gr√®ce",
      "Grenade","Guatemala","Guin√©e","Guin√©e-Bissau","Guin√©e √©quatoriale","Guyana","Ha√Øti","Honduras","Hongrie","Inde",
      "Indon√©sie","Irak","Iran","Irlande","Islande","Italie","Jama√Øque","Japon","Jordanie","Kazakhstan",
      "Kenya","Kirghizistan","Kiribati","Kosovo","Kowe√Øt","Laos","Lesotho","Lettonie","Liban","Lib√©ria","Libye",
      "Liechtenstein","Lituanie","Luxembourg","Mac√©doine du Nord","Madagascar","Malaisie","Malawi","Maldives","Mali",
      "Malte","Maroc","Marshall","Maurice","Mauritanie","Mexique","Micron√©sie","Moldavie","Monaco","Mongolie","Mont√©n√©gro",
      "Mozambique","Namibie","Nauru","N√©pal","Nicaragua","Niger","Nig√©ria","Norv√®ge","Nouvelle-Z√©lande","Oman","Ouganda",
      "Ouzb√©kistan","Palestine","Pakistan","Palaos","Panama","Papouasie-Nouvelle-Guin√©e","Paraguay","Pays-Bas","P√©rou","Philippines",
      "Pologne","Portugal","Qatar","R√©publique centrafricaine","R√©publique dominicaine","R√©publique tch√®que","Roumanie",
      "Royaume-Uni","Russie","Rwanda","Saint-Christophe-et-Ni√©v√®s","Sainte-Lucie","Saint-Marin","Saint-Vincent-et-les-Grenadines",
      "Salomon","Salvador","Samoa","S√£o Tom√©-et-Principe","S√©n√©gal","Serbie","Seychelles","Sierra Leone","Singapour",
      "Slovaquie","Slov√©nie","Somalie","Soudan","Soudan du Sud","Sri Lanka","Su√®de","Suisse","Suriname","Syrie","Tadjikistan",
      "Tanzanie","Tchad","Tha√Ølande","Timor oriental","Togo","Tonga","Trinit√©-et-Tobago","Tunisie","Turkm√©nistan","Turquie",
      "Tuvalu","Ukraine","Uruguay","Vanuatu","Vatican","Venezuela","Vi√™t Nam","Y√©men","Zambie","Zimbabwe"
    ];

    // ----- Pretty, keyboard-friendly autocomplete -----
    (function countryAutocomplete(){
      const input = document.getElementById('countryInput');
      const list  = document.getElementById('countryList');

      const norm = s => (s||"").normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase();
      let items = [], active = -1;

      function render(results){
        list.innerHTML = '';
        if (!results.length){
          list.innerHTML = `<li class="ac-empty">Aucun r√©sultat</li>`;
          list.hidden = false; input.setAttribute('aria-expanded','true'); return;
        }
        results.forEach((name, i)=>{
          const li = document.createElement('li');
          li.className = 'ac-item';
          li.id = 'ac-item-'+i;
          li.role = 'option';
          li.innerHTML = `<span class="dot" aria-hidden="true"></span><span>${name}</span>`;
          li.addEventListener('mousedown', e=> e.preventDefault());
          li.addEventListener('click', ()=> select(i));
          list.appendChild(li);
        });
        list.hidden = false;
        input.setAttribute('aria-expanded','true');
        active = -1;
        items = Array.from(list.querySelectorAll('.ac-item'));
      }

      function select(i){
        if (i<0 || i>=items.length) return hide();
        const val = items[i].innerText.trim();
        input.value = val;
        hide();
        input.dispatchEvent(new Event('input', {bubbles:true}));
        input.dispatchEvent(new Event('change', {bubbles:true}));
      }

      function hide(){
        list.hidden = true;
        input.setAttribute('aria-expanded','false');
        active = -1; items = [];
      }

      input.addEventListener('input', ()=>{
        const q = norm(input.value);
        if (!q){ hide(); return; }
        const results = COUNTRIES.filter(c => norm(c).includes(q)).slice(0, 12);
        render(results);
      });

      input.addEventListener('keydown', (e)=>{
        if (list.hidden) return;
        if (e.key === 'ArrowDown'){ e.preventDefault(); move(1); }
        else if (e.key === 'ArrowUp'){ e.preventDefault(); move(-1); }
        else if (e.key === 'Enter'){ e.preventDefault(); select(active); }
        else if (e.key === 'Escape'){ hide(); }
      });

      function move(step){
        if (!items.length) return;
        active = (active + step + items.length) % items.length;
        items.forEach((el,idx)=> el.classList.toggle('is-active', idx===active));
        const id = items[active].id;
        input.setAttribute('aria-activedescendant', id);
        items[active].scrollIntoView({block:'nearest'});
      }

      input.addEventListener('blur', ()=> setTimeout(hide, 80));
      input.setAttribute('autocomplete','off');
    })();

    // --- Submit with XHR + progress (click-only; no native submit) ---
    (function(){
      const form = $('#qform');
      const submitBtn = $('#submitBtn');
      const bar = $('#prog');
      const statusEl = $('#status');

      // Prevent Enter from native submit (except textarea)
      form.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA'){
          e.preventDefault();
          submitBtn.click();
        }
      });

      submitBtn.addEventListener('click', async ()=>{
        $('#msg').style.display='none'; statusEl.textContent=''; bar.style.display='none';

        // Honeypot
        if (form.querySelector('.hp')?.value.trim()){ return; }

        // Required checks
        if (!$('#consent').checked){ showMessage('Veuillez accepter la case de consentement pour continuer.', 'error'); return; }
        const bag = window.__getFiles?.() || [];
        if (bag.length === 0){ showMessage('Veuillez joindre au moins une photo ou une radio panoramique.', 'error'); return; }
        if (bag.length > MAX_FILES){ showMessage('Trop de fichiers (max 10).', 'error'); return; }

        // Build FormData
        const fd = new FormData(form);
        fd.set('consent','true'); fd.delete('files');
        bag.forEach(f => fd.append('files', f));

        submitBtn.disabled = true; bar.style.display='inline-block'; bar.value = 0; statusEl.textContent='T√©l√©versement‚Ä¶';

        try{
          const xhr = new XMLHttpRequest();
          xhr.open('POST', API_URL, true);
          xhr.upload.onprogress = ev => { if (ev.lengthComputable) bar.value = Math.round((ev.loaded/ev.total)*100); };
          const done = new Promise((res,rej)=>{
            xhr.onreadystatechange = () => {
              if (xhr.readyState === 4){
                (xhr.status>=200 && xhr.status<300) ? res(xhr.responseText) : rej(new Error(xhr.responseText||'√âchec de l‚Äôenvoi'));
              }
            };
            xhr.onerror = () => rej(new Error('Erreur r√©seau'));
          });
          xhr.send(fd);

          const raw = await done; const out = JSON.parse(raw||'{}');
          const ref = out.id || 'N/A';
          sessionStorage.setItem('quoteSuccess', JSON.stringify({ id: ref, t: Date.now() }));

          // Clean form state immediately on success
          resetFormUI(form);

          // Show the clean success modal
          showSuccessModal(ref);

          statusEl.textContent='Termin√©';
          bar.value = 0;

        }catch(err){
          console.error(err);
          showMessage('D√©sol√©, une erreur est survenue. R√©essayez.', 'error');
          statusEl.textContent='Erreur';
        }finally{
          submitBtn.disabled = false;
          setTimeout(()=> bar.style.display='none', 800);
        }
      });

      // Clean phone inputs
      $all('input[inputmode="tel"]').forEach(inp => inp.addEventListener('input', ()=> inp.value = inp.value.replace(/[^\d+ ]/g,'')));
    })();

    function resetFormUI(form){
      try{
        form.reset();
        window.__resetFiles?.();
        $('#treatHidden').value = '';
        // Nudge the progress meter back to 0
        $('#meter').style.width = '0%';
       showMessage('Votre demande a √©t√© envoy√©e. Vous pouvez fermer ce message.', 'success'); // no 3rd arg
      }catch(_e){}
    }

    // Success Modal helper (clean + accessible)
    function showSuccessModal(refId) {
      const dlg = document.getElementById('successDialog');
      const txt = document.getElementById('successText');
      const refEl = document.getElementById('successRef');
      const copyBtn = document.getElementById('copyRefBtn');
      const ok  = document.getElementById('successCloseBtn');

      refEl.textContent = refId || 'N/A';
      txt.textContent = 'Merci ! Votre demande a bien √©t√© envoy√©e. Un conseiller vous r√©pond sous 24 h.';

      // Copy reference
      copyBtn.onclick = async () => {
        try { await navigator.clipboard.writeText(refEl.textContent); copyBtn.textContent='Copi√©'; setTimeout(()=>copyBtn.textContent='Copier la r√©f√©rence', 1500); }
        catch(_e){ /* ignore */ }
      };

      // Lock ESC close so the user uses buttons (still accessible)
      const preventCancel = (e) => e.preventDefault();
      dlg.addEventListener('cancel', preventCancel);

      // Prevent backdrop click from closing
      dlg.addEventListener('click', (e)=>{
        const r = dlg.getBoundingClientRect();
        const inside = e.clientX >= r.left && e.clientX <= r.right && e.clientY >= r.top && e.clientY <= r.bottom;
        if (!inside) e.preventDefault();
      });

      ok.onclick = () => {
        dlg.removeEventListener('cancel', preventCancel);
        sessionStorage.removeItem('quoteSuccess');
        if (dlg.close) dlg.close(); else dlg.removeAttribute('open');
      };

      if (dlg.showModal) dlg.showModal(); else dlg.setAttribute('open','');
      ok.focus();
    }
    (function () {
  try {
    const raw = sessionStorage.getItem('quoteSuccess');
    if (!raw) return;
    const { id, t } = JSON.parse(raw);
    if (Date.now() - (t || 0) < 10 * 60 * 1000) { // 10 min window
      showSuccessModal(id);
    } else {
      sessionStorage.removeItem('quoteSuccess');
    }
  } catch (_) {}
})();

  </script>

  <!-- Success dialog (clean) -->
  <dialog id="successDialog" class="modal" aria-labelledby="successTitle" aria-modal="true">
    <div class="modal-head">
      <div class="checkwrap" aria-hidden="true">‚úì</div>
      <div>
        <span class="badge">Succ√®s</span><br/>
        <b id="successTitle">Demande envoy√©e</b>
      </div>
    </div>

    <p id="successText" style="margin:6px 0 8px 0"></p>
    <p class="small">R√©f√©rence : <span class="ref" id="successRef">N/A</span></p>
    <button type="button" id="copyRefBtn" class="copy-btn" style="margin:6px 0 12px 0">Copier la r√©f√©rence</button>

    <div class="modal-actions">
      <button type="button" class="btn btn-outline" onclick="openWhatsApp()">Parler sur WhatsApp</button>
      <button type="button" class="btn btn-turq" id="successCloseBtn">OK</button>
    </div>
  </dialog>
  <!-- Language FAB + i18n -->
<style>
  #langFab{position:fixed;right:16px;bottom:16px;z-index:50}
  #langFab .fab{
    width:52px;height:52px;border-radius:50%;
    background:#fff;border:2px solid #e5e7eb;
    box-shadow:0 10px 30px rgba(0,0,0,.18);
    display:flex;align-items:center;justify-content:center;cursor:pointer
  }
  #langFab .menu{
    position:absolute;right:0;bottom:60px;background:#111827;color:#fff;
    border-radius:12px;padding:6px;box-shadow:0 20px 50px rgba(0,0,0,.35);
    opacity:0;transform:translateY(8px);transition:.15s;pointer-events:none
  }
  #langFab.open .menu{opacity:1;transform:translateY(0);pointer-events:auto}
  #langFab .menu button{
    display:flex;align-items:center;gap:8px;background:transparent;color:#fff;
    border:0;padding:8px 10px;border-radius:10px;cursor:pointer;font-weight:700
  }
  #langFab .menu button:hover{background:#1f2937}
  #langFab .menu .active{background:#0f172a}

  /* fallback <img> size for the FAB + menu */
  #langFab .flag-img{width:24px;height:24px;border-radius:50%;display:inline-block;vertical-align:middle}
  #langFab .menu .flag-img{width:18px;height:18px}


</style>

<div id="langFab" aria-label="Choose language">
  <button class="fab" id="langFabBtn" title="Language">üåê</button>
  <div class="menu" id="langMenu" role="menu" aria-label="Languages"></div>
</div>

<script>

(function ensureFlagsShow(){
  // if a .fi element has no background-image, swap it with an <img>
  document.querySelectorAll('#langFab .flag.fi').forEach(sp => {
    const bg = getComputedStyle(sp).backgroundImage;
    if (!bg || bg === 'none') {
      const m = sp.className.match(/fi-([a-z]{2})\b/i);
      const code = m && m[1] ? m[1].toLowerCase() : null;
      if (!code) return;
      const img = document.createElement('img');
      img.className = 'flag-img';
      // square (1x1) looks best inside a circle FAB
      img.src = `https://cdn.jsdelivr.net/npm/flag-icons@6.6.6/flags/1x1/${code}.svg`;
      img.alt = '';
      sp.replaceWith(img);
    }
  });
})();

(function(){
  /* ============ Languages & translations ============ */
  const LANGS = [
    { code:'fr', label:'Fran√ßais', dir:'ltr' },
    { code:'en', label:'English',  dir:'ltr' },
    { code:'es', label:'Espa√±ol',  dir:'ltr' },
    { code:'de', label:'Deutsch',  dir:'ltr' },
    { code:'it', label:'Italiano', dir:'ltr' },
    { code:'ar', label:'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',  dir:'rtl' },
  ];

  const T = {
    fr:{
      title:'Devis dentaire ‚Äî Smile Tunisia',
      'nav.back':'‚Üê Retour',

      h1:'Devis dentaire gratuit',
      lead:'R√©ponse <b>sous 24 h</b>, sans engagement. Transmission <b>s√©curis√©e</b>.',
      'trust.badges':['‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ Avis v√©rifi√©s','+500 patients accompagn√©s','R√©seau de cliniques certifi√©es','Planification 3D (CBCT)','Devis clair ¬∑ 0 frais cach√©s'],

      // form labels / placeholders
      'form.name':'Nom et pr√©nom *','ph.name':'Votre nom complet',
      'form.email':'Email *','ph.email':'vous@example.com',
      'form.phone':'T√©l√©phone / WhatsApp *','ph.phone':'+216 ...',
      'form.country':'Pays','ph.country':'Commencez √† taper‚Ä¶',

      // treatments
      tImplant:'Implant', tAllOn:'All-on-4/6', tVeneers:'Facettes', tAligners:'Aligneurs',
      tCrowns:'Couronnes / Bridges', tDentures:'Proth√®ses dentaires', tEndo:'Endodontie', tCaries:'Caries', tWhitening:'Blanchiment',

      // urgency
      uNow:'üìÖ D√®s que possible', uSoon:'üóìÔ∏è 1‚Äì3 mois', uLater:'‚è≥ Plus tard',

      // files / text area
      filesHelp:'T√©l√©versez une <b>photo de vos dents</b> (smartphone ok) ou une <b>radio panoramique</b>.',
      filesBtn:'Choisir des fichiers',
      filesDZ:'Glissez-d√©posez ici vos photos / PDF (max 10, 10 MB chacun)',
      filesNote:'Conseil : une photo bouche ouverte + un selfie sourire aident √† estimer votre cas.',
      'ph.notes':'Votre objectif : dents manquantes, esth√©tique, douleur‚Ä¶ Ajoutez tout d√©tail utile.',

      // consent + privacy
      consent:'J‚Äôaccepte de recevoir mon devis et des informations par WhatsApp et email (confidentiel, pas de spam).',
      privacy:'Transmission chiffr√©e (HTTPS). Acc√®s restreint √† l‚Äô√©quipe soignante. <a href="../legal/confidentialite.html">Politique de confidentialit√©</a>.',

      // actions
      submit:'Envoyer ma demande',
      statusUploading:'T√©l√©versement‚Ä¶', statusDone:'Termin√©', statusError:'Erreur',

      // reassurance column
      rDoctorTitle:'√âquipe m√©dicale certifi√©e',
      rDoctorLine:'Implantologie & esth√©tique ‚Äî r√©seau de cliniques audit√©es.',
      rDoctorQuote:'‚ÄúProtocoles s√ªrs, mat√©riaux CE/FDA, r√©sultat naturel.‚Äù',

      rGet:'Ce que vous recevez',
      rGetList:['Un <b>devis clair</b> avec options & d√©lais','Une <b>explication du protocole</b> propos√©','Un <b>conseiller d√©di√©</b> sur WhatsApp'],

      rData:'Donn√©es & confidentialit√©',
      rDataList:['Envoi via <b>connexion s√©curis√©e (HTTPS)</b>','Acc√®s limit√© √† l‚Äô√©quipe soignante','<b>Suppression sur demande</b> (RGPD)'],

      rNext:'Et apr√®s ?',
      rNextList:['√âtude de vos photos/radio','Devis sous 24 h avec options','Organisation du s√©jour si souhait√©'],

      stars:'‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ',
      'reviews.r1':'Suivi WhatsApp rassurant.',
      'reviews.r2':'All-on-4 en 5 jours.',
      'reviews.r3':'Facettes impeccables.',

      // FAQ
      faq1q:'Le devis est-il payant ?', faq1a:'Non, il est <b>gratuit</b> et sans engagement.',
      faq2q:'Dois-je avancer des frais ?', faq2a:'Aucun frais avant la premi√®re visite. Vols/h√¥tel √† votre charge si vous organisez seul.',
      faq3q:'Et si je n‚Äôai pas de radio ?', faq3a:'Envoyez juste des <b>photos</b>. Une radio pourra √™tre prescrite ensuite si besoin.',
      advisorBtn:'Parler √† un conseiller',

      // WhatsApp message
      waMsg:'Bonjour, je souhaite des informations pour un devis dentaire.',

      // Modal
      'm.badge':'Succ√®s', 'm.title':'Demande envoy√©e',
      'm.text':'Merci ! Votre demande a bien √©t√© envoy√©e. Un conseiller vous r√©pond sous 24 h.',
      'm.ref':'R√©f√©rence :', 'm.copy':'Copier la r√©f√©rence', 'm.copied':'Copi√©',
      'm.wa':'Parler sur WhatsApp', 'm.ok':'OK',

      // Runtime messages (shim)
      errTooBig:'Un fichier d√©passe 10 MB et a √©t√© ignor√©.',
      errConsent:'Veuillez accepter la case de consentement pour continuer.',
      errNeedFiles:'Veuillez joindre au moins une photo ou une radio panoramique.',
      errTooMany:'Trop de fichiers (max 10).',
      errGeneric:'D√©sol√©, une erreur est survenue. R√©essayez.'
    },

    en:{
      title:'Dental quote ‚Äî Smile Tunisia',
      'nav.back':'‚Üê Back',
      h1:'Free dental quote',
      lead:'Reply <b>within 24 h</b>, no obligation. <b>Secure</b> transfer.',
      'trust.badges':['‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ Verified reviews','500+ patients assisted','Network of certified clinics','3D planning (CBCT)','Clear quote ¬∑ no hidden fees'],

      'form.name':'Full name *','ph.name':'Your full name',
      'form.email':'Email *','ph.email':'you@example.com',
      'form.phone':'Phone / WhatsApp *','ph.phone':'+216 ...',
      'form.country':'Country','ph.country':'Start typing‚Ä¶',

      tImplant:'Implant', tAllOn:'All-on-4/6', tVeneers:'Veneers', tAligners:'Aligners',
      tCrowns:'Crowns / Bridges', tDentures:'Dentures', tEndo:'Endodontics', tCaries:'Cavities', tWhitening:'Whitening',

      uNow:'üìÖ As soon as possible', uSoon:'üóìÔ∏è 1‚Äì3 months', uLater:'‚è≥ Later',

      filesHelp:'Upload a <b>photo of your teeth</b> (phone is fine) or a <b>panoramic X-ray</b>.',
      filesBtn:'Choose files',
      filesDZ:'Drag & drop your photos / PDFs here (max 10, 10 MB each)',
      filesNote:'Tip: one open-mouth photo + a smiling selfie help estimate your case.',
      'ph.notes':'Your goal: missing teeth, aesthetics, pain‚Ä¶ Add any useful details.',

      consent:'I agree to receive my quote and information by WhatsApp and email (confidential, no spam).',
      privacy:'Encrypted transfer (HTTPS). Access restricted to the care team. <a href="../legal/confidentialite.html">Privacy policy</a>.',

      submit:'Send my request',
      statusUploading:'Uploading‚Ä¶', statusDone:'Done', statusError:'Error',

      rDoctorTitle:'Certified medical team',
      rDoctorLine:'Implantology & aesthetics ‚Äî network of audited clinics.',
      rDoctorQuote:'‚ÄúSafe protocols, CE/FDA materials, natural result.‚Äù',

      rGet:'What you receive',
      rGetList:['A <b>clear quote</b> with options & timelines','An <b>explanation of the proposed protocol</b>','A <b>dedicated advisor</b> on WhatsApp'],

      rData:'Data & privacy',
      rDataList:['Sent via <b>secure connection (HTTPS)</b>','Limited access for the care team','<b>Deletion on request</b> (GDPR)'],

      rNext:'What happens next?',
      rNextList:['Review of your photos/X-ray','Quote within 24 h with options','Trip organization if desired'],

      stars:'‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ',
      'reviews.r1':'Reassuring WhatsApp follow-up.',
      'reviews.r2':'All-on-4 in 5 days.',
      'reviews.r3':'Impeccable veneers.',

      faq1q:'Is the quote paid?', faq1a:'No, it is <b>free</b> and without obligation.',
      faq2q:'Do I need to pay upfront?', faq2a:'No fees before the first visit. Flights/hotel at your expense if you book yourself.',
      faq3q:'What if I don‚Äôt have an X-ray?', faq3a:'Just send <b>photos</b>. An X-ray can be prescribed later if needed.',
      advisorBtn:'Talk to an advisor',

      waMsg:'Hello, I‚Äôd like information about a dental quote.',

      "m.badge":'Success', "m.title":'Request sent',
      "m.text":'Thank you! Your request has been sent. An advisor will reply within 24 h.',
      "m.ref":'Reference:', "m.copy":'Copy reference', "m.copied":'Copied',
      "m.wa":'Chat on WhatsApp', "m.ok":'OK',

      errTooBig:'A file exceeds 10 MB and was ignored.',
      errConsent:'Please accept the consent checkbox to continue.',
      errNeedFiles:'Please attach at least one photo or a panoramic X-ray.',
      errTooMany:'Too many files (max 10).',
      errGeneric:'Sorry, an error occurred. Please try again.'
    },

    es:{
      title:'Presupuesto dental ‚Äî Smile Tunisia',
      'nav.back':'‚Üê Volver',
      h1:'Presupuesto dental gratis',
      lead:'Respuesta <b>en 24 h</b>, sin compromiso. Transferencia <b>segura</b>.',
      'trust.badges':['‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ Rese√±as verificadas','500+ pacientes acompa√±ados','Red de cl√≠nicas certificadas','Planificaci√≥n 3D (CBCT)','Presupuesto claro ¬∑ sin costes ocultos'],

      'form.name':'Nombre y apellidos *','ph.name':'Tu nombre completo',
      'form.email':'Email *','ph.email':'tu@ejemplo.com',
      'form.phone':'Tel√©fono / WhatsApp *','ph.phone':'+216 ...',
      'form.country':'Pa√≠s','ph.country':'Empieza a escribir‚Ä¶',

      tImplant:'Implante', tAllOn:'All-on-4/6', tVeneers:'Carillas', tAligners:'Alineadores',
      tCrowns:'Coronas / Puentes', tDentures:'Pr√≥tesis', tEndo:'Endodoncia', tCaries:'Caries', tWhitening:'Blanqueamiento',

      uNow:'üìÖ Lo antes posible', uSoon:'üóìÔ∏è 1‚Äì3 meses', uLater:'‚è≥ M√°s tarde',

      filesHelp:'Sube una <b>foto de tus dientes</b> (m√≥vil vale) o una <b>radiograf√≠a panor√°mica</b>.',
      filesBtn:'Elegir archivos',
      filesDZ:'Arrastra y suelta aqu√≠ tus fotos / PDF (m√°x. 10, 10 MB cada uno)',
      filesNote:'Consejo: una foto con boca abierta + un selfie sonriendo ayudan a estimar tu caso.',
      'ph.notes':'Tu objetivo: dientes ausentes, est√©tica, dolor‚Ä¶ A√±ade detalles √∫tiles.',

      consent:'Acepto recibir mi presupuesto e informaci√≥n por WhatsApp y email (confidencial, sin spam).',
      privacy:'Transmisi√≥n cifrada (HTTPS). Acceso restringido al equipo m√©dico. <a href="../legal/confidentialite.html">Pol√≠tica de privacidad</a>.',

      submit:'Enviar mi solicitud',
      statusUploading:'Subiendo‚Ä¶', statusDone:'Hecho', statusError:'Error',

      rDoctorTitle:'Equipo m√©dico certificado',
      rDoctorLine:'Implantolog√≠a y est√©tica ‚Äî red de cl√≠nicas auditadas.',
      rDoctorQuote:'‚ÄúProtocolos seguros, materiales CE/FDA, resultado natural.‚Äù',

      rGet:'Lo que recibes',
      rGetList:['Un <b>presupuesto claro</b> con opciones y plazos','Una <b>explicaci√≥n del protocolo</b> propuesto','Un <b>asesor dedicado</b> por WhatsApp'],

      rData:'Datos y privacidad',
      rDataList:['Env√≠o por <b>conexi√≥n segura (HTTPS)</b>','Acceso limitado al equipo m√©dico','<b>Eliminaci√≥n a solicitud</b> (RGPD)'],

      rNext:'¬øY despu√©s?',
      rNextList:['Estudio de tus fotos/radiograf√≠a','Presupuesto en 24 h con opciones','Organizaci√≥n del viaje si se desea'],

      stars:'‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ',
      'reviews.r1':'Seguimiento por WhatsApp tranquilizador.',
      'reviews.r2':'All-on-4 en 5 d√≠as.',
      'reviews.r3':'Carillas impecables.',

      faq1q:'¬øEl presupuesto es de pago?', faq1a:'No, es <b>gratis</b> y sin compromiso.',
      faq2q:'¬øDebo adelantar gastos?', faq2a:'Ning√∫n pago antes de la primera visita. Vuelos/hotel a tu cargo si los gestionas t√∫.',
      faq3q:'¬øY si no tengo radiograf√≠a?', faq3a:'Env√≠a solo <b>fotos</b>. La radiograf√≠a podr√° pedirse despu√©s si hace falta.',
      advisorBtn:'Hablar con un asesor',

      waMsg:'Hola, quisiera informaci√≥n para un presupuesto dental.',

      "m.badge":'√âxito', "m.title":'Solicitud enviada',
      "m.text":'¬°Gracias! Hemos recibido tu solicitud. Un asesor responder√° en 24 h.',
      "m.ref":'Referencia:', "m.copy":'Copiar referencia', "m.copied":'Copiado',
      "m.wa":'Hablar por WhatsApp', "m.ok":'OK',

      errTooBig:'Un archivo supera 10 MB y se ignor√≥.',
      errConsent:'Acepta la casilla de consentimiento para continuar.',
      errNeedFiles:'Adjunta al menos una foto o una radiograf√≠a panor√°mica.',
      errTooMany:'Demasiados archivos (m√°x. 10).',
      errGeneric:'Lo sentimos, ocurri√≥ un error. Int√©ntalo de nuevo.'
    },

    de:{
      title:'Zahn-Kostenvoranschlag ‚Äî Smile Tunisia',
      'nav.back':'‚Üê Zur√ºck',
      h1:'Kostenloser Kostenvoranschlag',
      lead:'Antwort <b>innerhalb von 24 Std.</b>, unverbindlich. <b>Sichere</b> √úbertragung.',
      'trust.badges':['‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ Verifizierte Bewertungen','500+ begleitete Patienten','Netz zertifizierter Kliniken','3D-Planung (CBCT)','Klares Angebot ¬∑ keine versteckten Kosten'],

      'form.name':'Vor- und Nachname *','ph.name':'Ihr vollst√§ndiger Name',
      'form.email':'E-Mail *','ph.email':'sie@beispiel.de',
      'form.phone':'Telefon / WhatsApp *','ph.phone':'+216 ...',
      'form.country':'Land','ph.country':'Tippen Sie‚Ä¶',

      tImplant:'Implantat', tAllOn:'All-on-4/6', tVeneers:'Veneers', tAligners:'Aligner',
      tCrowns:'Kronen / Br√ºcken', tDentures:'Prothesen', tEndo:'Endodontie', tCaries:'Karies', tWhitening:'Bleaching',

      uNow:'üìÖ So bald wie m√∂glich', uSoon:'üóìÔ∏è 1‚Äì3 Monate', uLater:'‚è≥ Sp√§ter',

      filesHelp:'Laden Sie ein <b>Foto Ihrer Z√§hne</b> (Handy ok) oder ein <b>Panorama-R√∂ntgen</b> hoch.',
      filesBtn:'Dateien w√§hlen',
      filesDZ:'Ziehen Sie Fotos / PDFs hierher (max. 10, je 10 MB)',
      filesNote:'Tipp: ein Foto mit offenem Mund + ein l√§chelndes Selfie helfen bei der Einsch√§tzung.',
      'ph.notes':'Ihr Ziel: fehlende Z√§hne, √Ñsthetik, Schmerz ‚Ä¶ Weitere Details willkommen.',

      consent:'Ich stimme zu, mein Angebot und Infos per WhatsApp und E-Mail zu erhalten (vertraulich, kein Spam).',
      privacy:'Verschl√ºsselte √úbertragung (HTTPS). Zugriff nur f√ºr das Behandlungsteam. <a href="../legal/confidentialite.html">Datenschutz</a>.',

      submit:'Anfrage senden',
      statusUploading:'Upload l√§uft‚Ä¶', statusDone:'Fertig', statusError:'Fehler',

      rDoctorTitle:'Zertifiziertes √Ñrzteteam',
      rDoctorLine:'Implantologie & √Ñsthetik ‚Äî Netzwerk gepr√ºfter Kliniken.',
      rDoctorQuote:'‚ÄûSichere Protokolle, CE/FDA-Materialien, nat√ºrliches Ergebnis.‚Äú',

      rGet:'Was Sie erhalten',
      rGetList:['Einen <b>klaren Kostenvoranschlag</b> mit Optionen & Zeitrahmen','Eine <b>Erkl√§rung des vorgeschlagenen Protokolls</b>','Einen <b>pers√∂nlichen Berater</b> via WhatsApp'],

      rData:'Daten & Datenschutz',
      rDataList:['Versand √ºber <b>gesicherte Verbindung (HTTPS)</b>','Beschr√§nkter Zugriff f√ºr das Team','<b>L√∂schung auf Anfrage</b> (DSGVO)'],

      rNext:'Wie geht es weiter?',
      rNextList:['Sichtung Ihrer Fotos/R√∂ntgen','Angebot binnen 24 Std. mit Optionen','Reiseorganisation auf Wunsch'],

      stars:'‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ',
      'reviews.r1':'Beruhigende WhatsApp-Nachsorge.',
      'reviews.r2':'All-on-4 in 5 Tagen.',
      'reviews.r3':'Makellose Veneers.',

      faq1q:'Ist das Angebot kostenpflichtig?', faq1a:'Nein, es ist <b>kostenlos</b> und unverbindlich.',
      faq2q:'Muss ich vorab zahlen?', faq2a:'Keine Geb√ºhren vor dem ersten Termin. Fl√ºge/Hotel bei Selbstbuchung eigenst√§ndig.',
      faq3q:'Kein R√∂ntgen vorhanden?', faq3a:'Senden Sie einfach <b>Fotos</b>. Ein R√∂ntgen kann sp√§ter veranlasst werden.',
      advisorBtn:'Mit Berater sprechen',

      waMsg:'Hallo, ich h√§tte gern Infos zu einem Zahnarzt-Kostenvoranschlag.',

      "m.badge":'Erfolg', "m.title":'Anfrage gesendet',
      "m.text":'Danke! Ihre Anfrage wurde gesendet. Ein Berater meldet sich innerhalb von 24 Std.',
      "m.ref":'Referenz:', "m.copy":'Referenz kopieren', "m.copied":'Kopiert',
      "m.wa":'Auf WhatsApp chatten', "m.ok":'OK',

      errTooBig:'Eine Datei ist gr√∂√üer als 10 MB und wurde ignoriert.',
      errConsent:'Bitte stimmen Sie der Einwilligung zu, um fortzufahren.',
      errNeedFiles:'Bitte f√ºgen Sie mindestens ein Foto oder ein Panorama-R√∂ntgen hinzu.',
      errTooMany:'Zu viele Dateien (max. 10).',
      errGeneric:'Leider ist ein Fehler aufgetreten. Bitte erneut versuchen.'
    },

    it:{
      title:'Preventivo dentale ‚Äî Smile Tunisia',
      'nav.back':'‚Üê Indietro',
      h1:'Preventivo dentale gratuito',
      lead:'Risposta <b>entro 24 h</b>, senza impegno. Trasmissione <b>sicura</b>.',
      'trust.badges':['‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ Recensioni verificate','500+ pazienti assistiti','Rete di cliniche certificate','Pianificazione 3D (CBCT)','Preventivo chiaro ¬∑ zero costi nascosti'],

      'form.name':'Nome e cognome *','ph.name':'Il tuo nome completo',
      'form.email':'Email *','ph.email':'tu@example.com',
      'form.phone':'Telefono / WhatsApp *','ph.phone':'+216 ...',
      'form.country':'Paese','ph.country':'Inizia a digitare‚Ä¶',

      tImplant:'Impianto', tAllOn:'All-on-4/6', tVeneers:'Faccette', tAligners:'Aligner',
      tCrowns:'Corone / Ponti', tDentures:'Protesi', tEndo:'Endodonzia', tCaries:'Carie', tWhitening:'Sbiancamento',

      uNow:'üìÖ Il prima possibile', uSoon:'üóìÔ∏è 1‚Äì3 mesi', uLater:'‚è≥ Pi√π tardi',

      filesHelp:'Carica una <b>foto dei denti</b> (va bene lo smartphone) o una <b>panoramica</b>.',
      filesBtn:'Scegli file',
      filesDZ:'Trascina qui foto / PDF (max 10, 10 MB ciascuno)',
      filesNote:'Consiglio: una foto a bocca aperta + un selfie col sorriso aiutano la stima.',
      'ph.notes':'Obiettivo: denti mancanti, estetica, dolore‚Ä¶ Aggiungi dettagli utili.',

      consent:'Accetto di ricevere il preventivo e le info via WhatsApp ed email (riservato, no spam).',
      privacy:'Trasmissione cifrata (HTTPS). Accesso limitato al team clinico. <a href="../legal/confidentialite.html">Privacy policy</a>.',

      submit:'Invia la richiesta',
      statusUploading:'Caricamento‚Ä¶', statusDone:'Fatto', statusError:'Errore',

      rDoctorTitle:'Team medico certificato',
      rDoctorLine:'Implantologia & estetica ‚Äî rete di cliniche verificate.',
      rDoctorQuote:'‚ÄúProtocolli sicuri, materiali CE/FDA, risultato naturale.‚Äù',

      rGet:'Cosa ricevi',
      rGetList:['Un <b>preventivo chiaro</b> con opzioni e tempi','Una <b>spiegazione del protocollo</b> proposto','Un <b>consulente dedicato</b> su WhatsApp'],

      rData:'Dati & privacy',
      rDataList:['Invio tramite <b>connessione sicura (HTTPS)</b>','Accesso limitato al team','<b>Cancellazione su richiesta</b> (GDPR)'],

      rNext:'E poi?',
      rNextList:['Studio di foto/radiografia','Preventivo entro 24 h con opzioni','Organizzazione del viaggio se desiderato'],

      stars:'‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ',
      'reviews.r1':'Follow-up WhatsApp rassicurante.',
      'reviews.r2':'All-on-4 in 5 giorni.',
      'reviews.r3':'Faccette impeccabili.',

      faq1q:'Il preventivo √® a pagamento?', faq1a:'No, √® <b>gratuito</b> e senza impegno.',
      faq2q:'Devo anticipare dei costi?', faq2a:'Nessun costo prima della prima visita. Voli/hotel a tuo carico se gestiti in autonomia.',
      faq3q:'E se non ho la panoramica?', faq3a:'Invia solo <b>foto</b>. La panoramica potr√† essere prescritta in seguito.',
      advisorBtn:'Parla con un consulente',

      waMsg:'Ciao, vorrei info per un preventivo dentale.',

      "m.badge":'Successo', "m.title":'Richiesta inviata',
      "m.text":'Grazie! La tua richiesta √® stata inviata. Un consulente risponder√† entro 24 h.',
      "m.ref":'Riferimento:', "m.copy":'Copia riferimento', "m.copied":'Copiato',
      "m.wa":'Parla su WhatsApp', "m.ok":'OK',

      errTooBig:'Un file supera 10 MB ed √® stato ignorato.',
      errConsent:'Accetta la casella di consenso per continuare.',
      errNeedFiles:'Allega almeno una foto o una panoramica.',
      errTooMany:'Troppi file (max 10).',
      errGeneric:'Si √® verificato un errore. Riprova.'
    },

    ar:{
      title:'ÿπÿ±ÿ∂ ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿ£ÿ≥ŸÜÿßŸÜ ‚Äî Smile Tunisia',
      'nav.back':'‚Üê ÿ±ÿ¨Ÿàÿπ',
      h1:'ÿπÿ±ÿ∂ ÿ£ÿ≥ÿπÿßÿ± ÿ£ÿ≥ŸÜÿßŸÜ ŸÖÿ¨ÿßŸÜŸä',
      lead:'ÿ±ÿØ <b>ÿÆŸÑÿßŸÑ 24 ÿ≥ÿßÿπÿ©</b> ÿ®ÿØŸàŸÜ ÿßŸÑÿ™ÿ≤ÿßŸÖ. ŸÜŸÇŸÑ <b>ÿ¢ŸÖŸÜ</b>.',
      'trust.badges':['‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ ÿ™ŸÇŸäŸäŸÖÿßÿ™ ŸÖŸàÿ´ŸëŸÇÿ©','+500 ŸÖÿ±Ÿäÿ∂Ÿãÿß ŸÖŸèÿ±ÿßŸÅŸéŸÇŸãÿß','ÿ¥ÿ®ŸÉÿ© ÿπŸäÿßÿØÿßÿ™ ŸÖÿπÿ™ŸÖÿØÿ©','ÿ™ÿÆÿ∑Ÿäÿ∑ ÿ´ŸÑÿßÿ´Ÿä ÿßŸÑÿ£ÿ®ÿπÿßÿØ (CBCT)','ÿπÿ±ÿ∂ Ÿàÿßÿ∂ÿ≠ ¬∑ ÿ®ÿØŸàŸÜ ÿ±ÿ≥ŸàŸÖ ŸÖÿÆŸÅŸäÿ©'],

      'form.name':'ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÉÿßŸÖŸÑ *','ph.name':'ÿßÿ≥ŸÖŸÉ ÿßŸÑŸÉÿßŸÖŸÑ',
      'form.email':'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä *','ph.email':'you@example.com',
      'form.phone':'ÿßŸÑŸáÿßÿ™ŸÅ / Ÿàÿßÿ™ÿ≥ÿßÿ® *','ph.phone':'+216 ...',
      'form.country':'ÿßŸÑÿØŸàŸÑÿ©','ph.country':'ÿßÿ®ÿØÿ£ ÿ®ÿßŸÑŸÉÿ™ÿßÿ®ÿ©‚Ä¶',

      tImplant:'ÿ≤ÿ±ÿπÿ©', tAllOn:'All-on-4/6', tVeneers:'ŸÅŸäŸÜŸäÿ±ÿßÿ™', tAligners:'ŸÖŸÇŸàŸÖÿßÿ™ ÿ¥ŸÅÿßŸÅÿ©',
      tCrowns:'ÿ™Ÿäÿ¨ÿßŸÜ / ÿ¨ÿ≥Ÿàÿ±', tDentures:'ÿ£ÿ∑ŸÇŸÖ ÿ£ÿ≥ŸÜÿßŸÜ', tEndo:'ÿπŸÑÿßÿ¨ ÿ¨ÿ∞Ÿàÿ±', tCaries:'ÿ™ÿ≥Ÿàÿ≥', tWhitening:'ÿ™ÿ®ŸäŸäÿ∂',

      uNow:'üìÖ ŸÅŸä ÿ£ŸÇÿ±ÿ® ŸàŸÇÿ™', uSoon:'üóìÔ∏è ÿÆŸÑÿßŸÑ 1‚Äì3 ÿ£ÿ¥Ÿáÿ±', uLater:'‚è≥ ŸÑÿßÿ≠ŸÇŸãÿß',

      filesHelp:'ÿßÿ±ŸÅŸéÿπ <b>ÿµŸàÿ±ÿ© ŸÑÿ£ÿ≥ŸÜÿßŸÜŸÉ</b> (ÿßŸÑŸáÿßÿ™ŸÅ ŸäŸÉŸÅŸä) ÿ£Ÿà <b>ÿ£ÿ¥ÿπÿ© ÿ®ÿßŸÜŸàÿ±ÿßŸÖŸäÿ©</b>.',
      filesBtn:'ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅÿßÿ™',
      filesDZ:'ÿßÿ≥ÿ≠ÿ® Ÿàÿ£ÿ≥ŸÇÿ∑ ÿßŸÑÿµŸàÿ± / PDF ŸáŸÜÿß (ÿ®ÿ≠ÿØ ÿ£ŸÇÿµŸâ 10ÿå 10 MB ŸÑŸÉŸÑ ŸÖŸÑŸÅ)',
      filesNote:'ŸÜÿµŸäÿ≠ÿ©: ÿµŸàÿ±ÿ© ŸÅŸÖ ŸÖŸÅÿ™Ÿàÿ≠ + ÿ≥ŸäŸÑŸÅŸä ÿßÿ®ÿ™ÿ≥ÿßŸÖÿ© ÿ™ÿ≥ÿßÿπÿØ ÿπŸÑŸâ ÿßŸÑÿ™ŸÇÿØŸäÿ±.',
      'ph.notes':'ŸáÿØŸÅŸÉ: ÿ£ÿ≥ŸÜÿßŸÜ ŸÖŸÅŸÇŸàÿØÿ©ÿå ÿ¨ŸÖÿßŸÑŸäÿ©ÿå ÿ£ŸÑŸÖ‚Ä¶ ÿ£ÿ∂ŸÅ ÿ£Ÿä ÿ™ŸÅÿßÿµŸäŸÑ ŸÖŸÅŸäÿØÿ©.',

      consent:'ÿ£ŸàÿßŸÅŸÇ ÿπŸÑŸâ ÿßÿ≥ÿ™ŸÑÿßŸÖ ÿßŸÑÿπÿ±ÿ∂ ŸàÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ® ŸàÿßŸÑÿ®ÿ±ŸäÿØ (ÿ®ÿ≥ÿ±Ÿäÿ©ÿå ÿØŸàŸÜ ÿ•ÿ≤ÿπÿßÿ¨).',
      privacy:'ŸÜŸÇŸÑ ŸÖÿ¥ŸÅŸëÿ± (HTTPS). ŸàÿµŸàŸÑ ŸÖÿ≠ÿØŸàÿØ ŸÑŸÅÿ±ŸäŸÇ ÿßŸÑÿ±ÿπÿßŸäÿ©. <a href="../legal/confidentialite.html">ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿÆÿµŸàÿµŸäÿ©</a>.',

      submit:'ÿ•ÿ±ÿ≥ÿßŸÑ ÿ∑ŸÑÿ®Ÿä',
      statusUploading:'ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ±ŸÅÿπ‚Ä¶', statusDone:'ÿ™ŸÖ', statusError:'ÿÆÿ∑ÿ£',

      rDoctorTitle:'ŸÅÿ±ŸäŸÇ ÿ∑ÿ®Ÿä ŸÖÿπÿ™ŸÖÿØ',
      rDoctorLine:'ÿ≤ÿ±ÿßÿπÿ© Ÿàÿ™ÿ¨ŸÖŸäŸÑ ‚Äî ÿ¥ÿ®ŸÉÿ© ÿπŸäÿßÿØÿßÿ™ ŸÖŸèÿØŸÇŸëŸéŸÇÿ©.',
      rDoctorQuote:'‚Äúÿ®ÿ±Ÿàÿ™ŸàŸÉŸàŸÑÿßÿ™ ÿ¢ŸÖŸÜÿ©ÿå ŸÖŸàÿßÿØ CE/FDAÿå ŸÜÿ™Ÿäÿ¨ÿ© ÿ∑ÿ®ŸäÿπŸäÿ©.‚Äù',

      rGet:'ŸÖÿßÿ∞ÿß ÿ≥ÿ™ÿ™ŸÑŸÇŸëŸâ',
      rGetList:['<b>ÿπÿ±ÿ∂ Ÿàÿßÿ∂ÿ≠</b> ŸÖÿπ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ ŸàÿßŸÑŸÖŸàÿßÿπŸäÿØ','<b>ÿ¥ÿ±ÿ≠ ÿßŸÑÿ®ÿ±Ÿàÿ™ŸàŸÉŸàŸÑ</b> ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠','<b>ŸÖÿ≥ÿ™ÿ¥ÿßÿ± ŸÖÿÆÿµÿµ</b> ÿπŸÑŸâ Ÿàÿßÿ™ÿ≥ÿßÿ®'],

      rData:'ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸàÿßŸÑÿÆÿµŸàÿµŸäÿ©',
      rDataList:['ÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± <b>ÿßÿ™ÿµÿßŸÑ ÿ¢ŸÖŸÜ (HTTPS)</b>','ŸàÿµŸàŸÑ ŸÖÿ≠ÿØŸàÿØ ŸÑŸÅÿ±ŸäŸÇ ÿßŸÑÿ±ÿπÿßŸäÿ©','<b>ÿ≠ÿ∞ŸÅ ÿπŸÜÿØ ÿßŸÑÿ∑ŸÑÿ®</b> (GDPR)'],

      rNext:'ŸàŸÖÿßÿ∞ÿß ÿ®ÿπÿØÿü',
      rNextList:['ÿØÿ±ÿßÿ≥ÿ© ÿßŸÑÿµŸàÿ±/ÿßŸÑÿ£ÿ¥ÿπÿ©','ÿπÿ±ÿ∂ ÿÆŸÑÿßŸÑ 24 ÿ≥ÿßÿπÿ© ŸÖÿπ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™','ÿ™ŸÜÿ∏ŸäŸÖ ÿßŸÑÿ±ÿ≠ŸÑÿ© ÿ•ŸÜ ÿ±ÿ∫ÿ®ÿ™'],

      stars:'‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ',
      'reviews.r1':'ŸÖÿ™ÿßÿ®ÿπÿ© ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ® ŸÖÿ∑ŸÖÿ¶ŸÜÿ©.',
      'reviews.r2':'All-on-4 ÿÆŸÑÿßŸÑ 5 ÿ£ŸäÿßŸÖ.',
      'reviews.r3':'ŸÅŸäŸÜŸäÿ±ÿßÿ™ ŸÖÿ™ŸÇŸÜÿ©.',

      faq1q:'ŸáŸÑ ÿßŸÑÿπÿ±ÿ∂ ŸÖÿØŸÅŸàÿπÿü', faq1a:'ŸÑÿßÿå ÿ•ŸÜŸá <b>ŸÖÿ¨ÿßŸÜŸä</b> Ÿàÿ®ÿØŸàŸÜ ÿßŸÑÿ™ÿ≤ÿßŸÖ.',
      faq2q:'ŸáŸÑ ÿπŸÑŸäŸë ÿØŸÅÿπ ÿ£Ÿä ÿ±ÿ≥ŸàŸÖÿü', faq2a:'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ±ÿ≥ŸàŸÖ ŸÇÿ®ŸÑ ÿßŸÑÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑÿ£ŸàŸÑŸâ. ÿßŸÑÿ±ÿ≠ŸÑÿßÿ™/ÿßŸÑŸÅŸÜÿØŸÇ ÿπŸÑŸâ ŸÜŸÅŸÇÿ™ŸÉ ÿ•ÿ∞ÿß ÿ≠ÿ¨ÿ≤ÿ™Ÿáÿß ÿ®ŸÜŸÅÿ≥ŸÉ.',
      faq3q:'ŸàŸÖÿßÿ∞ÿß ŸÑŸà ŸÑŸÖ ÿ™ŸÉŸÜ ŸÑÿØŸäŸë ÿ£ÿ¥ÿπÿ©ÿü', faq3a:'ÿ£ÿ±ÿ≥ŸÑ <b>ÿµŸàÿ±Ÿãÿß</b> ŸÅŸÇÿ∑. ŸäŸÖŸÉŸÜ ÿ∑ŸÑÿ® ÿßŸÑÿ£ÿ¥ÿπÿ© ŸÑÿßÿ≠ŸÇŸãÿß ÿ•ÿ∞ÿß ŸÑÿ≤ŸÖ ÿßŸÑÿ£ŸÖÿ±.',
      advisorBtn:'ÿßŸÑÿ™ÿ≠ÿØÿ´ ŸÖÿπ ŸÖÿ≥ÿ™ÿ¥ÿßÿ±',

      waMsg:'ŸÖÿ±ÿ≠ÿ®Ÿãÿßÿå ÿ£ŸàÿØ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ≠ŸàŸÑ ÿπÿ±ÿ∂ ÿ£ÿ≥ÿπÿßÿ± ŸÑŸÑÿ£ÿ≥ŸÜÿßŸÜ.',

      "m.badge":'ŸÜÿ¨ÿßÿ≠', "m.title":'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ®',
      "m.text":'ÿ¥ŸÉÿ±Ÿãÿß! ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ∑ŸÑÿ®ŸÉ. ÿ≥Ÿäÿ±ÿØŸë ÿπŸÑŸäŸÉ ŸÖÿ≥ÿ™ÿ¥ÿßÿ± ÿÆŸÑÿßŸÑ 24 ÿ≥ÿßÿπÿ©.',
      "m.ref":'ÿßŸÑŸÖÿ±ÿ¨ÿπ:', "m.copy":'ŸÜÿ≥ÿÆ ÿßŸÑŸÖÿ±ÿ¨ÿπ', "m.copied":'ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ',
      "m.wa":'ÿßŸÑÿØÿ±ÿØÿ¥ÿ© ÿπŸÑŸâ Ÿàÿßÿ™ÿ≥ÿßÿ®', "m.ok":'ÿ≠ÿ≥ŸÜŸãÿß',

      errTooBig:'ŸÖŸÑŸÅ ÿ£ŸÉÿ®ÿ± ŸÖŸÜ 10 MB ŸàŸÇÿØ ÿ™ŸÖ ÿ™ÿ¨ÿßŸáŸÑŸá.',
      errConsent:'Ÿäÿ±ÿ¨Ÿâ ŸÇÿ®ŸàŸÑ ŸÖÿ±ÿ®ÿπ ÿßŸÑŸÖŸàÿßŸÅŸÇÿ© ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ©.',
      errNeedFiles:'Ÿäÿ±ÿ¨Ÿâ ÿ•ÿ±ŸÅÿßŸÇ ÿµŸàÿ±ÿ© Ÿàÿßÿ≠ÿØÿ© ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ ÿ£Ÿà ÿ£ÿ¥ÿπÿ© ÿ®ÿßŸÜŸàÿ±ÿßŸÖŸäÿ©.',
      errTooMany:'ÿπÿØÿØ ŸÉÿ®Ÿäÿ± ŸÖŸÜ ÿßŸÑŸÖŸÑŸÅÿßÿ™ (ÿßŸÑÿ≠ÿØ 10).',
      errGeneric:'ÿπÿ∞ÿ±Ÿãÿßÿå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£. ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.'
    }
  };

  /* ============ tiny helpers ============ */
  const $ = (s,el=document)=>el.querySelector(s);
  const setText = (sel, txt)=>{ const el=$(sel); if(el && typeof txt==='string') el.textContent=txt; };
  const setHTML = (sel, html)=>{ const el=$(sel); if(el && typeof html==='string') el.innerHTML=html; };
  const setList = (sel, arr)=>{ const el=$(sel); if(el && Array.isArray(arr)) el.innerHTML=arr.map(x=>`<li>${x}</li>`).join(''); };
  const setPlaceholder = (sel, txt)=>{ const el=$(sel); if(el) el.setAttribute('placeholder', txt); };
  const setLabelForInputName = (name, txt)=>{
    const input = document.querySelector(`[name="${name}"]`); if(!input) return;
    const label = input.closest('div')?.querySelector('label'); if(label) label.textContent = txt;
  };

  /* ============ Apply language ============ */
  function apply(lang){
    const P = T[lang] || T.fr;

    // lang + dir
    document.documentElement.lang = lang;
    document.documentElement.dir = (lang==='ar') ? 'rtl' : 'ltr';
    document.body.style.direction = document.documentElement.dir;

    document.title = P.title;

    // top
    setText('header nav .btn.btn-outline', P['nav.back']);
    setText('h1', P.h1);
    setHTML('.lead', P.lead);

    // trust belt
    const rail = $('.trust-rail');
    if (rail && P['trust.badges']) rail.innerHTML = P['trust.badges'].map(x=>`<span class="t-badge">${x}</span>`).join('');

    // form labels / PH
    setLabelForInputName('name',  P['form.name']); setPlaceholder('input[name="name"]',  P['ph.name']);
    setLabelForInputName('email', P['form.email']); setPlaceholder('input[name="email"]', P['ph.email']);
    setLabelForInputName('phone', P['form.phone']); setPlaceholder('input[name="phone"]', P['ph.phone']);
    setText('label[for="countryInput"]', P['form.country']); setPlaceholder('#countryInput', P['ph.country']);

    // treatments
    const t = [
      ['.tcard:nth-child(1) .visual b', 'tImplant'],
      ['.tcard:nth-child(2) .visual b', 'tAllOn'],
      ['.tcard:nth-child(3) .visual b', 'tVeneers'],
      ['.tcard:nth-child(4) .visual b', 'tAligners'],
      ['.tcard:nth-child(5) .visual b', 'tCrowns'],
      ['.tcard:nth-child(6) .visual b', 'tDentures'],
      ['.tcard:nth-child(7) .visual b', 'tEndo'],
      ['.tcard:nth-child(8) .visual b', 'tCaries'],
      ['.tcard:nth-child(9) .visual b', 'tWhitening'],
    ];
    t.forEach(([sel,key])=> setText(sel, P[key]));

    // urgency
    setText('.seg label:nth-child(1) span', P.uNow);
    setText('.seg label:nth-child(2) span', P.uSoon);
    setText('.seg label:nth-child(3) span', P.uLater);

    // files
    setHTML('.files .drop .help', P.filesHelp);
    setText('#chooseBtn', P.filesBtn);
    setText('#dz', P.filesDZ);
    setText('.files .note', P.filesNote);
    setPlaceholder('textarea[name="notes"]', P['ph.notes']);

    // consent + privacy + submit
    setText('.consent span', P.consent);
    setHTML('.consent ~ .note', P.privacy);
    setText('#submitBtn', P.submit);

    // reassurance column
    const docCard = $('.r-card.doctor');
    if (docCard){
      setText('.r-card.doctor b', P.rDoctorTitle);
      const lines = $('.r-card.doctor b').parentNode;
      // replace the two following text nodes/line:
      const p = $('.r-card.doctor .note').parentNode;
      lines.childNodes[2].nodeValue = ''; // clear old
      $('.r-card.doctor .note').textContent = P.rDoctorQuote;
      // main line:
      const textHolder = $('.r-card.doctor b').nextSibling;
      if (textHolder && textHolder.nodeType===3) textHolder.nodeValue = ' ';
      $('.r-card.doctor b').parentElement.childNodes.forEach(n=>{
        /* noop, handled below with setText to a new element if needed */
      });
      // ensure main line text
      const afterB = $('.r-card.doctor b').parentElement.querySelector('br').nextSibling;
      if (afterB && afterB.nodeType===3) afterB.nodeValue = P.rDoctorLine + '\n';
    }
    setText('.r-card:nth-of-type(2) > b', P.rGet);
    setList('.r-card:nth-of-type(2) ul', P.rGetList);

    setText('.r-card:nth-of-type(3) > b', P.rData);
    setList('.r-card:nth-of-type(3) ul', P.rDataList);

    setText('.r-card:nth-of-type(4) > b', P.rNext);
    setList('.r-card:nth-of-type(4) ol', P.rNextList);

    setText('.r-card:nth-of-type(5) .stars', P.stars);
    // mini-reviews (order: SB, ML, AK) ‚Üí r3, r2, r1 (to match your avatars)
    const rBoxes = document.querySelectorAll('.mini-reviews .review-mini .txt');
    if (rBoxes[0]) rBoxes[0].innerHTML = `<b>‚Äú${P['reviews.r3']}‚Äù</b>`;
    if (rBoxes[1]) rBoxes[1].innerHTML = `<b>‚Äú${P['reviews.r2']}‚Äù</b>`;
    if (rBoxes[2]) rBoxes[2].innerHTML = `<b>‚Äú${P['reviews.r1']}‚Äù</b>`;

    // FAQ
    const faqs = document.querySelectorAll('.r-faq');
    if (faqs[0]){ faqs[0].querySelector('summary').textContent = P.faq1q; faqs[0].querySelector('p').innerHTML = P.faq1a; }
    if (faqs[1]){ faqs[1].querySelector('summary').textContent = P.faq2q; faqs[1].querySelector('p').innerHTML = P.faq2a; }
    if (faqs[2]){ faqs[2].querySelector('summary').textContent = P.faq3q; faqs[2].querySelector('p').innerHTML = P.faq3a; }
    setText('aside .btn.btn-outline', P.advisorBtn);

    // WhatsApp opener (override to localized default message)
    window.openWhatsApp = function(){
      const phone = document.body.dataset.whatsapp || '';
      const msg = encodeURIComponent(P.waMsg);
      window.open(`https://wa.me/${phone}?text=${msg}`, '_blank');
    };

    // modal static labels
    setText('#successDialog .badge', P['m.badge']);
    setText('#successTitle', P['m.title']);
    setText('#successCloseBtn', P['m.ok']);
    setText('#copyRefBtn', P['m.copy']);
    setText('.modal-actions .btn.btn-outline', P['m.wa']); // WA button label

    // expose current strings for shims
    window.__I18N_Q = P;

    // status text shim (translate whenever it changes)
    const status = document.getElementById('status');
    if (!status.__i18nObs){
      const map = {
        'T√©l√©versement‚Ä¶':'statusUploading','Termin√©':'statusDone','Erreur':'statusError',
        'Uploading‚Ä¶':'statusUploading','Done':'statusDone','Error':'statusError'
      };
      const mo = new MutationObserver(()=> {
        const val = status.textContent.trim();
        const key = map[val]; if (key && __I18N_Q[key]) status.textContent = __I18N_Q[key];
      });
      mo.observe(status, {childList:true, subtree:true, characterData:true});
      status.__i18nObs = mo;
    }
  }

  /* ====== Shim showMessage so existing code shows localized text ====== */
  const _origShowMessage = window.showMessage;
  window.showMessage = function(text, type, ms){
    const P = window.__I18N_Q || T.fr;
    const map = {};
    // map French & English fallbacks to keys
    map[T.fr.errTooBig]   = 'errTooBig';
    map[T.en.errTooBig]   = 'errTooBig';
    map[T.fr.errConsent]  = 'errConsent';
    map[T.en.errConsent]  = 'errConsent';
    map[T.fr.errNeedFiles]= 'errNeedFiles';
    map[T.en.errNeedFiles]= 'errNeedFiles';
    map[T.fr.errTooMany]  = 'errTooMany';
    map[T.en.errTooMany]  = 'errTooMany';
    map[T.fr.errGeneric]  = 'errGeneric';
    map[T.en.errGeneric]  = 'errGeneric';

    const k = map[text];
    const localized = k ? (P[k] || text) : text;
    return _origShowMessage(localized, type, ms);
  };

  // When the success modal is shown by your code, adjust its dynamic texts
  const dlg = document.getElementById('successDialog');
  if (dlg){
    dlg.addEventListener('close', ()=>{ /* noop */ });
    dlg.addEventListener('toggle', ()=>{ /* noop */ });
    // patch open to always localize contents
    const obs = new MutationObserver(()=>{
      const P = window.__I18N_Q || T.fr;
      const txt = document.getElementById('successText');
      const copyBtn = document.getElementById('copyRefBtn');
      if (txt) txt.textContent = P['m.text'];
      if (copyBtn){
        copyBtn.textContent = P['m.copy'];
        copyBtn.onclick = async ()=> {
          try{ await navigator.clipboard.writeText(document.getElementById('successRef').textContent);
               copyBtn.textContent = P['m.copied']; setTimeout(()=>copyBtn.textContent=P['m.copy'],1500);
          }catch(_){}
        };
      }
    });
    obs.observe(dlg, {attributes:true, attributeFilter:['open']});
  }

  /* ===== Build FAB ===== */
  const btn = document.getElementById('langFabBtn');
  const menu = document.getElementById('langMenu');
  const FLAG = { fr:'fr', en:'gb', es:'es', de:'de', it:'it', ar:'tn' }; // change 'gb'->'us' if you prefer
const flagUrl = lang => `https://cdn.jsdelivr.net/npm/flag-icons@6.6.6/flags/1x1/${FLAG[lang]||lang}.svg`;

function setFabFlag(lang){
  const label = (LANGS.find(x=>x.code===lang)||{}).label || 'Language';
  btn.innerHTML = `<img class="flag-img" alt="" src="${flagUrl(lang)}">`;
  btn.title = label; btn.setAttribute('aria-label', label);
}

  LANGS.forEach(l=>{
  const b = document.createElement('button');
  b.type = 'button';
  b.dataset.code = l.code;
  b.innerHTML = `<img class="flag-img" alt="" src="${flagUrl(l.code)}"><span>${l.label}</span>`;
  b.onclick = ()=>{
    localStorage.setItem('quote_lang', l.code);
    apply(l.code);
    setFabFlag(l.code);
    menu.querySelectorAll('button').forEach(x=> x.classList.toggle('active', x===b));
    document.getElementById('langFab').classList.remove('open');
  };
  menu.appendChild(b);
});

  btn.addEventListener('click', ()=> document.getElementById('langFab').classList.toggle('open'));
  document.addEventListener('click', e=>{ const w=document.getElementById('langFab'); if(!w.contains(e.target)) w.classList.remove('open'); });

  // init
  const saved = localStorage.getItem('quote_lang') || (navigator.language||'fr').slice(0,2);
  const init = LANGS.find(x=>x.code===saved) ? saved : 'fr';
  apply(init);
  setFabFlag(init);
  menu.querySelectorAll('button').forEach(x=> x.classList.toggle('active', x.dataset.code===init));
})();
</script>

</body>
</html>
